---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// 1. 生成所有文章的静态路径
export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

// 2. 获取当前文章内容
const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
	<main class="max-w-3xl mx-auto px-6 py-20">
		<header class="mb-12 text-center">
			<time class="font-sans text-sm text-stone-400 uppercase tracking-widest">
				{post.data.date.toLocaleDateString('en-us', {
					year: 'numeric',
					month: 'long',
					day: 'numeric',
				})}
			</time>
			<h1 class="font-serif text-5xl mt-4 mb-6 leading-tight text-charcoal">
				{post.data.title}
			</h1>
			<p class="font-sans text-xl text-stone-500 max-w-2xl mx-auto">
				{post.data.description}
			</p>
		</header>

		<hr class="border-stone-200 mb-12 w-24 mx-auto" />

		<article class="prose prose-stone prose-lg mx-auto font-serif hover:prose-a:text-terracotta prose-img:rounded-lg">
			<Content />
		</article>
	</main>
</Layout>