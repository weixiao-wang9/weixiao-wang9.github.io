---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

const papers = (await getCollection('research')).sort(
	(a, b) => new Date(b.data.date || 0).getTime() - new Date(a.data.date || 0).getTime()
);
---

<Layout title="Research">
	<main class="max-w-6xl mx-auto px-6 py-24">

		<header class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-24 border-b border-stone-300 pb-12">
			<h1 class="font-serif text-6xl md:text-7xl text-charcoal tracking-tight">
				Research
			</h1>
			<div class="flex flex-col justify-end">
				<p class="font-sans text-xl text-stone-600 leading-relaxed max-w-md">
					Selected publications & working papers on algebraic topology, active learning, and the geometry of neural representations.
				</p>
			</div>
		</header>

		<div class="grid grid-cols-1 md:grid-cols-12 gap-8">
			<div class="md:col-span-9 md:col-start-4 space-y-20">
				{papers.length === 0 ? (
					<p class="text-stone-500 italic text-lg border-t border-stone-300 pt-8">No papers yet. Check back soon!</p>
				) : (
					papers.map((paper) => (
						<a href={`/research/${paper.slug}`} class="block group">
							<article class="border-t border-stone-300 pt-8 transition-all duration-500">

								<div class="flex items-center gap-3 mb-3">
									{paper.data.date && (
										<time datetime={paper.data.date.toISOString()} class="font-sans text-xs font-bold text-terracotta uppercase tracking-widest">
											{paper.data.date.toLocaleDateString('en-us', {
												year: 'numeric',
												month: 'short',
											})}
										</time>
									)}
									<span class="w-8 h-[1px] bg-terracotta opacity-50"></span>
									{paper.data.status && (
										<span class="font-sans text-xs font-bold text-stone-400 uppercase tracking-widest">
											{paper.data.status}
										</span>
									)}
								</div>

								<h2 class="font-serif text-4xl md:text-5xl leading-[1.1] text-charcoal group-hover:text-terracotta transition-colors duration-300 mb-6">
									{paper.data.title}
								</h2>

								{paper.data.description && (
									<p class="font-sans text-lg text-stone-600 leading-relaxed max-w-2xl mb-6">
										{paper.data.description}
									</p>
								)}

								{paper.data.tags && paper.data.tags.length > 0 && (
									<div class="flex flex-wrap gap-2 mb-6">
										{paper.data.tags.map((tag) => (
											<span class="font-sans text-xs text-stone-400 px-2 py-1 border border-stone-200 rounded">
												{tag}
											</span>
										))}
									</div>
								)}

								<div class="flex items-center gap-2 text-charcoal font-sans text-sm font-bold uppercase tracking-widest group-hover:gap-4 transition-all duration-300">
									<span>Read More</span>
									<svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-terracotta">
										<path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
										<path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									</svg>
								</div>
							</article>
						</a>
					))
				)}
			</div>
		</div>
	</main>
</Layout>
